000100*AAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBIIIIIIII
000110*Compile statement: cob2 -x ./log_reader.cbl -o log_reader
000200 IDENTIFICATION DIVISION.
000400  PROGRAM-ID. LOGANALYZER.
000500  AUTHOR. ELIAS GAUTHIER.
000600  DATE-WRITTEN. 19/03/2025
000700  DATE-COMPILED. 19/02/2025.
000800  REMARKS. This program reads and displays log files content.
000900*
001000 ENVIRONMENT DIVISION.
001100  CONFIGURATION SECTION.
001200   SOURCE-COMPUTER. Debian_Linux_x86_12.
001300   OBJECT-COMPUTER. Debian_Linux_x86_12.
001400  INPUT-OUTPUT SECTION.
001500   FILE-CONTROL.
001600    SELECT LOG-FILE ASSIGN TO FILENAME
001700     ORGANIZATION IS SEQUENTIAL
001800     FILE STATUS IS WS-FILE-STATUS.
001900*
002000 DATA DIVISION.
002100  FILE SECTION.
002200  FD LOG-FILE
002300     RECORDING MODE IS F
002400     BLOCK CONTAINS 0 RECORDS.
002500   01 LOG-RECORD.
002600    05 LOG-DATA         PIC X(200).
002700*
002800  WORKING-STORAGE SECTION.
002900   01 WS-FILE-STATUS    PIC XX VALUE SPACES.
003000   01 FILENAME          PIC X(100) VALUE SPACES.
003100   01 WS-EOF            PIC X VALUE 'N'.
003200    88 END-OF-FILE      VALUE 'Y'.
003300    88 NOT-END-OF-FILE  VALUE 'N'.
003400   01 WS-LINE-COUNTER   PIC 9(6) VALUE ZEROES.
003500   01 WS-ERROR-MESSAGE  PIC X(100) VALUE SPACES.
003600*
003700 PROCEDURE DIVISION.
003800 MAIN-PROCEDURE.
003900    DISPLAY "LOG FILE ANALYZER"
004000    DISPLAY "=================="
004100    DISPLAY "Enter log file path: " WITH NO ADVANCING
004200    ACCEPT FILENAME
004300    
004400    PERFORM OPEN-FILE
004500    
004600    IF WS-FILE-STATUS = "00"
004700       PERFORM READ-LOG-FILE UNTIL END-OF-FILE
004800       PERFORM CLOSE-FILE
004900       DISPLAY "Total lines read: " WS-LINE-COUNTER
005000    END-IF
005100    
005200    STOP RUN.
005300*
005400 OPEN-FILE.
005500    OPEN INPUT LOG-FILE
005600    EVALUATE WS-FILE-STATUS
005700       WHEN "00"
005800          DISPLAY "File opened successfully."
005900       WHEN "35"
006000          DISPLAY "File does not exist."
006100       WHEN OTHER
006200          STRING "Error opening file. Status: " DELIMITED BY SIZE
006300                 WS-FILE-STATUS DELIMITED BY SIZE
006400                 INTO WS-ERROR-MESSAGE
006500          DISPLAY WS-ERROR-MESSAGE
006600    END-EVALUATE.
006700*
006800 READ-LOG-FILE.
006900    READ LOG-FILE
007000       AT END 
007100          SET END-OF-FILE TO TRUE
007200       NOT AT END
007300          ADD 1 TO WS-LINE-COUNTER
007400          DISPLAY WS-LINE-COUNTER ": " LOG-DATA
007500    END-READ.
007600*
007700 CLOSE-FILE.
007800    CLOSE LOG-FILE.
